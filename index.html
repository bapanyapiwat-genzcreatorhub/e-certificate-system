<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gen Z Top Sales - Evaluation</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <img src="https://ba.pim.ac.th/wp/wp-content/uploads/2025/09/logo.png" alt="PIM BA Gen Z Logos">
            <p>‡∏Ñ‡∏ì‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏†‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡πå</p>
            <h2>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ Gen Z Top Sales</h2>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ‡πÅ‡∏•‡∏∞ E-Certificate</p>
        </header>

        <main id="landing-card" class="card">
            <div class="icon">üìÑ</div>
            <h2>‡∏£‡πà‡∏ß‡∏°‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ‡πÅ‡∏•‡∏∞ ‡∏£‡∏±‡∏ö E-Certificate</h2>
            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
            <div class="info-box">
                <p>üïí ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤: ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1-2 ‡∏ô‡∏≤‡∏ó‡∏µ</p>
                <p>üìù ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: 11 ‡∏Ç‡πâ‡∏≠</p>
            </div>
            <button id="start-btn" class="action-button">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‚ûî</button>
        </main>
        <main id="form-card-part1" class="card" style="display: none;">
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3>
                <button class="back-button">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 0%;"></div>
                </div><span>0%</span>
            </div>
            <form id="evaluation-form-part1">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h4>
                <div class="form-group"><label>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                    <div class="radio-group"><label><input type="radio" name="prefix" value="‡∏ô‡∏≤‡∏¢"
                                required>‡∏ô‡∏≤‡∏¢</label><label><input type="radio" name="prefix" value="‡∏ô‡∏≤‡∏á">
                            ‡∏ô‡∏≤‡∏á</label><label><input type="radio" name="prefix" value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß"> ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</label></div>
                </div>
                <div class="form-group"><label for="firstName">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ ‡∏ä‡∏∑‡πà‡∏≠</label><input type="text" id="firstName"
                        required></div>
                <div class="form-group"><label for="lastName">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="lastName"
                        required></div>
                <div class="form-group"><label for="studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label><input type="text" id="studentId"
                        required></div>
                <div class="form-group"><label for="mobile">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label><input type="tel" id="mobile" required>
                </div>
                <div class="form-group"><label for="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label><input type="email" id="email" required></div>
                <div class="form-group"><label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                    <div class="radio-group"><label><input type="radio" name="campus" value="‡πÅ‡∏à‡πâ‡∏á‡∏ß‡∏±‡∏í‡∏ô‡∏∞"
                                required>‡πÅ‡∏à‡πâ‡∏á‡∏ß‡∏±‡∏í‡∏ô‡∏∞</label><label><input type="radio" name="campus"
                                value="‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡∏≠‡∏µ‡∏≠‡∏µ‡∏ã‡∏µ">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡∏≠‡∏µ‡∏≠‡∏µ‡∏ã‡∏µ</label><label><input type="radio" name="campus"
                                value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label></div>
                </div>
                <button type="submit" class="action-button next-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
            </form>
        </main>
        <main id="form-card-part2" class="card" style="display: none;">
            <div class="summary-box">
                <div><span id="summary-prefix-name-p2"></span> (<span
                        id="summary-lastname-p2"></span>)<br><small>(‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span
                            id="summary-studentid-p2"></span>)</small><br><small>(‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span
                            id="summary-campus-p2"></span>)</small></div>
                <div class="summary-right">(<span id="summary-email-p2"></span>)<br><button class="edit-button">‚úé
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
            </div>
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3><button class="back-button">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 20%;"></div>
                </div><span>20%</span>
            </div>
            <form id="evaluation-form-part2">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏î‡πâ‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£</h4>
                <div class="likert-group"><label>‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q1"
                                value="5">5</label><label><input type="radio" name="q1" value="4">4</label><label><input
                                type="radio" name="q1" value="3">3</label><label><input type="radio" name="q1"
                                value="2">2</label><label><input type="radio" name="q1" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q2"
                                value="5">5</label><label><input type="radio" name="q2" value="4">4</label><label><input
                                type="radio" name="q2" value="3">3</label><label><input type="radio" name="q2"
                                value="2">2</label><label><input type="radio" name="q2" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡πâ‡∏ã‡∏±‡∏Å‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q3"
                                value="5">5</label><label><input type="radio" name="q3" value="4">4</label><label><input
                                type="radio" name="q3" value="3">3</label><label><input type="radio" name="q3"
                                value="2">2</label><label><input type="radio" name="q3" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q4"
                                value="5">5</label><label><input type="radio" name="q4" value="4">4</label><label><input
                                type="radio" name="q4" value="3">3</label><label><input type="radio" name="q4"
                                value="2">2</label><label><input type="radio" name="q4" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <button type="submit" class="action-button next-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
            </form>
        </main>
        <main id="form-card-part3" class="card" style="display: none;">
            <div class="summary-box">
                <div><span id="summary-prefix-name-p3"></span> (<span
                        id="summary-lastname-p3"></span>)<br><small>(‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span
                            id="summary-studentid-p3"></span>)</small><br><small>(‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span
                            id="summary-campus-p3"></span>)</small></div>
                <div class="summary-right">(<span id="summary-email-p3"></span>)<br><button class="edit-button">‚úé
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
            </div>
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3><button class="back-button">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 40%;"></div>
                </div><span>40%</span>
            </div>
            <form id="evaluation-form-part3">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à</h4>
                <div class="likert-group"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q5"
                                value="5">5</label><label><input type="radio" name="q5" value="4">4</label><label><input
                                type="radio" name="q5" value="3">3</label><label><input type="radio" name="q5"
                                value="2">2</label><label><input type="radio" name="q5" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ö‡∏£‡∏°</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q6"
                                value="5">5</label><label><input type="radio" name="q6" value="4">4</label><label><input
                                type="radio" name="q6" value="3">3</label><label><input type="radio" name="q6"
                                value="2">2</label><label><input type="radio" name="q6" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <button type="submit" class="action-button next-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
            </form>
        </main>
        <main id="form-card-part4" class="card" style="display: none;">
            <div class="summary-box">
                <div><span id="summary-prefix-name-p4"></span> (<span
                        id="summary-lastname-p4"></span>)<br><small>(‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span
                            id="summary-studentid-p4"></span>)</small><br><small>(‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span
                            id="summary-campus-p4"></span>)</small></div>
                <div class="summary-right">(<span id="summary-email-p4"></span>)<br><button class="edit-button">‚úé
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
            </div>
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3><button class="back-button">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 60%;"></div>
                </div><span>60%</span>
            </div>
            <form id="evaluation-form-part4">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ</h4>
                <div class="likert-group"><label>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q7"
                                value="5">5</label><label><input type="radio" name="q7" value="4">4</label><label><input
                                type="radio" name="q7" value="3">3</label><label><input type="radio" name="q7"
                                value="2">2</label><label><input type="radio" name="q7" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÑ‡∏õ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà/‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡πÅ‡∏Å‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q8"
                                value="5">5</label><label><input type="radio" name="q8" value="4">4</label><label><input
                                type="radio" name="q8" value="3">3</label><label><input type="radio" name="q8"
                                value="2">2</label><label><input type="radio" name="q8" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <button type="submit" class="action-button next-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
            </form>
        </main>
        <main id="form-card-part5" class="card" style="display: none;">
            <div class="summary-box">
                <div><span id="summary-prefix-name-p5"></span> (<span
                        id="summary-lastname-p5"></span>)<br><small>(‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span
                            id="summary-studentid-p5"></span>)</small><br><small>(‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span
                            id="summary-campus-p5"></span>)</small></div>
                <div class="summary-right">(<span id="summary-email-p5"></span>)<br><button class="edit-button">‚úé
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
            </div>
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3><button class="back-button">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 80%;"></div>
                </div><span>80%</span>
            </div>
            <form id="evaluation-form-part5">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h4>
                <div class="likert-group"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q9"
                                value="5">5</label><label><input type="radio" name="q9" value="4">4</label><label><input
                                type="radio" name="q9" value="3">3</label><label><input type="radio" name="q9"
                                value="2">2</label><label><input type="radio" name="q9" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q10"
                                value="5">5</label><label><input type="radio" name="q10"
                                value="4">4</label><label><input type="radio" name="q10"
                                value="3">3</label><label><input type="radio" name="q10"
                                value="2">2</label><label><input type="radio" name="q10" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <div class="likert-group"><label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°</label>
                    <div class="likert-scale"><span>‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span><label><input type="radio" name="q11"
                                value="5">5</label><label><input type="radio" name="q11"
                                value="4">4</label><label><input type="radio" name="q11"
                                value="3">3</label><label><input type="radio" name="q11"
                                value="2">2</label><label><input type="radio" name="q11" value="1"
                                required>1</label><span>‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span></div>
                </div>
                <button type="submit" class="action-button next-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
            </form>
        </main>
        <main id="form-card-part6" class="card" style="display: none;">
            <div class="summary-box">
                <div><span id="summary-prefix-name-p6"></span> (<span
                        id="summary-lastname-p6"></span>)<br><small>(‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span
                            id="summary-studentid-p6"></span>)</small><br><small>(‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span
                            id="summary-campus-p6"></span>)</small></div>
                <div class="summary-right">(<span id="summary-email-p6"></span>)<br><button class="edit-button">‚úé
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
            </div>
            <div class="form-header">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3><button class="back-button">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
            <div class="progress-section"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 100%;"></div>
                </div><span>100%</span>
            </div>
            <form id="evaluation-form-part6">
                <h4>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h4>
                <div class="form-group"><label for="suggestions">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label><textarea id="suggestions"
                        name="suggestions" rows="4"></textarea></div>
                <button type="submit" class="action-button next-button">‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>
            </form>
        </main>

        <main id="success-card" class="card" style="display: none;">
            <div class="form-header" style="border-bottom: none; justify-content: center;">
                <h3>‡∏£‡∏∞‡∏ö‡∏ö E-Certificate</h3>
            </div>
            <div class="success-icon">
                <span>‚úî</span>
            </div>
            <h4>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</h4>
            <p>‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå (E-Certificate) ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ Download ‡πÅ‡∏•‡πâ‡∏ß</p>
            <div class="cert-preview-wrapper">
                <embed id="cert-preview-embed" src="" type="application/pdf" width="100%" height="300px" />
                <div class="cert-id-overlay">
                    Certificate ID: <span id="cert-id-preview"></span>
                </div>
            </div>
            <div class="button-group" style="margin-top: 1.5rem; flex-direction: column; gap: 0.8rem;">
                <button id="download-cert-btn" class="action-button">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</button>
                <button id="view-scores-btn" class="back-button">üìä ‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>
                <button id="back-to-home-btn" class="back-button">üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
            </div>
        </main>
    </div>

    <script type="module">
        // 1. Import functions from the Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getDatabase, ref, update } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";

        // 2. Your web app's Firebase configuration
        const firebaseConfig = {
            // !!! ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ Config ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà !!!
            apiKey: "AIzaSyD_7eO7WoAm5CIQlCIcnYJfIXRJu35NJg4",
            authDomain: "genzcreatorhub-firebase.firebaseapp.com",
            databaseURL: "https://genzcreatorhub-firebase-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "genzcreatorhub-firebase",
            storageBucket: "genzcreatorhub-firebase.firebasestorage.app",
            messagingSenderId: "550010826564",
            appId: "1:550010826564:web:2751d7e0530c80bd4eb111",
            measurementId: "G-B0QRMC1P6S"
        };

        // 3. Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // --- ‡∏î‡∏∂‡∏á Element ‡∏ï‡πà‡∏≤‡∏á‡πÜ ---
        const container = document.querySelector('.container');
        const allCards = document.querySelectorAll('.card');
        const forms = document.querySelectorAll('form');

        let currentStudentId = null;
        let personalData = {};
        let evaluationAnswers = {};
        let generatedPdfDoc = null;
        const STORAGE_KEY = 'evaluationFormData';
        const { jsPDF } = window.jspdf;

        // --- Functions (‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö) ---
        function showCard(cardId) {
            allCards.forEach(card => card.style.display = 'none');
            const cardToShow = document.getElementById(cardId);
            if (cardToShow) cardToShow.style.display = 'block';
        }

        function updateAllSummaries(data) {
            document.querySelectorAll('.summary-box').forEach((box) => {
                box.querySelector('[id^="summary-prefix-name"]').innerText = data.prefix + ' ' + data.firstName;
                box.querySelector('[id^="summary-lastname"]').innerText = data.lastName;
                box.querySelector('[id^="summary-studentid"]').innerText = data.studentId;
                box.querySelector('[id^="summary-email"]').innerText = data.email;
                box.querySelector('[id^="summary-campus"]').innerText = data.campus;
            });
        }

        function handleEditInfo() {
            Swal.fire({
                title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß',
                html: `
                <div id="swal-form" style="text-align: left;">
                    <div class="form-group"><label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label><div class="radio-group"><label><input type="radio" name="swal-prefix" value="‡∏ô‡∏≤‡∏¢" ${personalData.prefix === '‡∏ô‡∏≤‡∏¢' ? 'checked' : ''}> ‡∏ô‡∏≤‡∏¢</label><label><input type="radio" name="swal-prefix" value="‡∏ô‡∏≤‡∏á" ${personalData.prefix === '‡∏ô‡∏≤‡∏á' ? 'checked' : ''}> ‡∏ô‡∏≤‡∏á</label><label><input type="radio" name="swal-prefix" value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß" ${personalData.prefix === '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß' ? 'checked' : ''}> ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</label></div></div>
                    <div class="form-group"><label for="swal-firstName">‡∏ä‡∏∑‡πà‡∏≠</label><input type="text" id="swal-firstName" class="swal2-input" value="${personalData.firstName || ''}"></div>
                    <div class="form-group"><label for="swal-lastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="swal-lastName" class="swal2-input" value="${personalData.lastName || ''}"></div>
                    <div class="form-group"><label for="swal-studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</label><input type="text" id="swal-studentId" class="swal2-input" value="${personalData.studentId || ''}" disabled></div>
                    <div class="form-group"><label for="swal-mobile">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</label><input type="tel" id="swal-mobile" class="swal2-input" value="${personalData.mobile || ''}"></div>
                    <div class="form-group"><label for="swal-email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label><input type="email" id="swal-email" class="swal2-input" value="${personalData.email || ''}"></div>
                    <div class="form-group"><label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label><div class="radio-group"><label><input type="radio" name="swal-campus" value="‡πÅ‡∏à‡πâ‡∏á‡∏ß‡∏±‡∏í‡∏ô‡∏∞" ${personalData.campus === '‡πÅ‡∏à‡πâ‡∏á‡∏ß‡∏±‡∏í‡∏ô‡∏∞' ? 'checked' : ''}> ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡∏±‡∏í‡∏ô‡∏∞</label><label><input type="radio" name="swal-campus" value="‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡∏≠‡∏µ‡∏≠‡∏µ‡∏ã‡∏µ" ${personalData.campus === '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡∏≠‡∏µ‡∏≠‡∏µ‡∏ã‡∏µ' ? 'checked' : ''}> ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡∏≠‡∏µ‡∏≠‡∏µ‡∏ã‡∏µ</label><label><input type="radio" name="swal-campus" value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" ${personalData.campus === '‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' ? 'checked' : ''}> ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label></div></div>
                </div>
            `,
                confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å', showCancelButton: true, confirmButtonColor: '#7367f0', cancelButtonColor: '#d33', focusConfirm: false,
                preConfirm: () => {
                    const prefix = document.querySelector('input[name="swal-prefix"]:checked');
                    const campus = document.querySelector('input[name="swal-campus"]:checked');
                    const newValues = {
                        prefix: prefix ? prefix.value : null,
                        firstName: document.getElementById('swal-firstName').value,
                        lastName: document.getElementById('swal-lastName').value,
                        mobile: document.getElementById('swal-mobile').value,
                        email: document.getElementById('swal-email').value,
                        campus: campus ? campus.value : null
                    };
                    if (Object.values(newValues).some(v => !v)) {
                        Swal.showValidationMessage(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô`);
                        return false;
                    }
                    return newValues;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Object.assign(personalData, result.value);
                    const studentRef = ref(database, 'evaluations/' + currentStudentId);
                    update(studentRef, result.value)
                        .then(() => {
                            updateAllSummaries(personalData);
                            Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß', 'success');
                        })
                        .catch(error => Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + error.message, 'error'));
                }
            });
        }

        async function loadFont(url) {
            const res = await fetch(url);
            const buffer = await res.arrayBuffer();
            let binary = '';
            const bytes = new Uint8Array(buffer);
            const len = bytes.byteLength;
            for (let i = 0; i < len; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }

        async function loadImageAsBase64(url) {
            const res = await fetch(url);
            const blob = await res.blob();
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result);
                reader.readAsDataURL(blob);
            });
        }

        async function generateCertificate(data, certId) {
            const doc = new jsPDF("l", "mm", "a4");
            const fontRegular = await loadFont("https://wichianp.github.io/fonts/THSarabunNew.ttf");
            const fontBold = await loadFont("https://wichianp.github.io/fonts/THSarabunNewBold.ttf");

            doc.addFileToVFS("THSarabunNew.ttf", fontRegular);
            doc.addFont("THSarabunNew.ttf", "THSarabunNew", "normal");
            doc.addFileToVFS("THSarabunNewBold.ttf", fontBold);
            doc.addFont("THSarabunNewBold.ttf", "THSarabunNew", "bold");

            const bg = await loadImageAsBase64("https://raw.githubusercontent.com/bapanyapiwat-genzcreatorhub/e-certificate-system/main/bg_web_1.jpg");
            doc.addImage(bg, "JPEG", 0, 0, 297, 210);

            const fullName = `${data.prefix} ${data.firstName} ${data.lastName}`;
            doc.setFont("THSarabunNew", "bold");
            doc.setFontSize(29.7);
            doc.setTextColor(255, 255, 255);
            doc.text(fullName, 148.5, 94, { align: "center" });

            const date = new Date();
            const formattedDate = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${date.getDate()} ${["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"][date.getMonth()]} ${date.getFullYear() + 543}`;
            doc.setFont("THSarabunNew", "normal");
            doc.setFontSize(15.2);
            doc.text(formattedDate, 148, 163, { align: "center" });

            doc.setFont("THSarabunNew", "bold");
            doc.setFontSize(12);
            doc.text(`{${certId}}`, 278, 188, { align: "right" });

            const qrDiv = document.createElement("div");
            new QRCode(qrDiv, { text: certId, width: 120, height: 120 });

            return new Promise(resolve => {
                setTimeout(() => {
                    const qrImg = qrDiv.querySelector("img").src;
                    doc.addImage(qrImg, "PNG", 24.5, 154.2);
                    resolve(doc);
                }, 500);
            });
        }

            function generateUUID() { 
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    
        function saveState(cardId, data, answers) {
            const state = { currentCardId: cardId, formData: data, answers: answers };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        // --- Event Listeners ---
        document.getElementById('start-btn').addEventListener('click', () => showCard('form-card-part1'));
        document.querySelectorAll('.edit-button').forEach(btn => btn.addEventListener('click', handleEditInfo));
        document.querySelectorAll('.back-button').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const currentCard = e.target.closest('.card');
                const currentCardId = currentCard.id;
                let targetCardId = '';
                if (currentCardId === 'form-card-part1') {
                    targetCardId = 'landing-card';
                    localStorage.removeItem(STORAGE_KEY);
                } else {
                    const currentPart = parseInt(currentCardId.slice(-1));
                    if (currentPart > 1) {
                        targetCardId = `form-card-part${currentPart - 1}`;
                    }
                }
                if (targetCardId) {
                    showCard(targetCardId);
                    saveState(targetCardId, personalData, evaluationAnswers);
                }
            });
        });

        document.getElementById('download-cert-btn').addEventListener('click', () => {
            if (generatedPdfDoc) {
                generatedPdfDoc.save(`certificate-${currentStudentId}.pdf`);
            }
        });

        document.getElementById('back-to-home-btn').addEventListener('click', () => location.reload());

        document.getElementById('view-scores-btn').addEventListener('click', () => {
            let scoresHtml = '<div style="text-align: left; padding: 0 1rem; max-height: 300px; overflow-y: auto;">';
            const friendlyKeys = {
                q1: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£", q2: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ï‡∏£‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô", q3: "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ã‡∏±‡∏Å‡∏ñ‡∏≤‡∏°", q4: "‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤",
                q5: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°", q6: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ö‡∏£‡∏°", q7: "‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô", q8: "‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà",
                q9: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö", q10: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå", q11: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤", suggestions: "‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞"
            };
            for (const key in evaluationAnswers) {
                const friendlyKey = friendlyKeys[key] || key;
                scoresHtml += `<p style="margin: 8px 0;"><strong>${friendlyKey}:</strong> <span style="color: #007bff;">${evaluationAnswers[key]}</span></p>`;
            }
            scoresHtml += '</div>';
            Swal.fire({
                title: '<strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</strong>', icon: 'info', html: scoresHtml, showCloseButton: true,
                focusConfirm: false, confirmButtonText: '‡∏õ‡∏¥‡∏î', confirmButtonColor: '#7367f0'
            });
        });

        // --- Form Submit Handlers ---
        forms.forEach((form) => {
            form.addEventListener('submit', (event) => {
                event.preventDefault();
                const part = parseInt(form.id.slice(-1));
                let dataToUpdate = {};

                if (part === 1) {
                    currentStudentId = document.getElementById('studentId').value;
                    if (!currentStudentId) { Swal.fire('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤', 'warning'); return; }
                    personalData = {
                        prefix: document.querySelector('input[name="prefix"]:checked')?.value || '',
                        firstName: document.getElementById('firstName').value,
                        lastName: document.getElementById('lastName').value,
                        studentId: currentStudentId,
                        mobile: document.getElementById('mobile').value,
                        email: document.getElementById('email').value,
                        campus: document.querySelector('input[name="campus"]:checked')?.value || '',
                        timestamp: new Date().toISOString()
                    };
                    dataToUpdate = personalData;
                } else {
                    const inputs = form.querySelectorAll('input:checked, textarea');
                    inputs.forEach(input => {
                        const key = input.name || input.id;
                        dataToUpdate[key] = input.value;
                    });
                    Object.assign(evaluationAnswers, dataToUpdate);
                }

                if (!currentStudentId) return;

                const studentRef = ref(database, 'evaluations/' + currentStudentId);
                update(studentRef, dataToUpdate)
                    .then(async () => {
                        console.log(`Part ${part} Data saved!`);
                        if (part < forms.length) {
                            const nextCardId = `form-card-part${part + 1}`;
                            updateAllSummaries(personalData);
                            showCard(nextCardId);
                            saveState(nextCardId, personalData, evaluationAnswers);
                        } else {
                            localStorage.removeItem(STORAGE_KEY);
                            Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á E-Certificate', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...', allowOutsideClick: false, didOpen: () => { Swal.showLoading() } });

                            const certificateId = generateUUID();
                            await update(ref(database, `evaluations/${currentStudentId}`), { certificateId: certificateId });

                            const doc = await generateCertificate(personalData, certificateId);
                            generatedPdfDoc = doc;

                            const pdfBlob = doc.output('blob');
                            const pdfUrl = URL.createObjectURL(pdfBlob);
                            document.getElementById('cert-preview-embed').src = pdfUrl;
                            document.getElementById('cert-id-preview').innerText = certificateId;

                            Swal.close();
                            showCard('success-card');
                        }
                    })
                    .catch(error => Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', `‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${error.message}`, 'error'));
            });
        });

        // --- ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏¥‡∏° ---
        (function loadState() {
            const savedStateJSON = localStorage.getItem(STORAGE_KEY);
            if (savedStateJSON) {
                const savedState = JSON.parse(savedStateJSON);
                personalData = savedState.formData;
                evaluationAnswers = savedState.answers || {};
                currentStudentId = personalData.studentId;

                showCard(savedState.currentCardId);
                if (savedState.currentCardId.startsWith('form-card-part') && savedState.currentCardId !== 'form-card-part1') {
                    updateAllSummaries(personalData);
                }
            }
        })();
    </script>

</html>
